{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    apiKey: \"\",\n    level: 0,\n    kanjiIds: []\n  },\n  reducers: {\n    setApiKey: (state, action) => {\n      state.apiKey = action.payload;\n    },\n    setLevel: (state, action) => {\n      state.level = action.payload;\n    },\n    setKanjiIds: (state, action) => {\n      // state.kanjiIds = action.payload;\n      console.log(action.payload);\n    }\n  }\n});\nexport const {\n  setApiKey,\n  setLevel,\n  setKanjiIds\n} = userSlice.actions;\nexport const initStudyByLevel = (selectedLevels = null, selectedStages = null) => {\n  var _s = $RefreshSig$();\n  return _s(async (dispatch, useState) => {\n    _s();\n    let url = \"https://api.wanikani.com/v2/subjects?types=kanji&started=true\";\n    if (selectedLevels) {\n      url += `&levels=${selectedLevels}`;\n    } else if (selectedStages) {\n      url += `&srs_stages=${selectedStages}`;\n    }\n    console.log(\"url\", url);\n    const apiKey = useState().user.apiKey;\n\n    // recursively fetch all pages of kanji ids\n    const fetchIds = async url => {\n      if (url) {\n        await axios.get(url, {\n          headers: {\n            Authorization: `Bearer ${apiKey}`\n          }\n        }).then(res => {\n          console.log(\"fetched\", res.data);\n          dispatch(setKanjiIds(res.data.data.map(kanji => {\n            if (kanji.data.visually_similar_subject_ids.length > 1) {\n              return {\n                id: kanji.id,\n                character: kanji.data.characters,\n                url: kanji.url,\n                level: kanji.data.level,\n                meanings: kanji.data.meanings.map(meaning => meaning.meaning),\n                similarIds: kanji.data.visually_similar_subject_ids\n              };\n            }\n          })));\n          if (res.data.pages.per_page > res.data.total_count && res.data.pages.next_url) {\n            console.log(\"fetching next page\");\n            fetchIds(res.data.pages.next_url);\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    };\n\n    // await fetchIds(\n    //   `https://api.wanikani.com/v2/assignments?subject_types=kanji&started=true&levels=${selectedLevels}`\n    // );\n    await fetchIds(url);\n  }, \"VhlnxxH3xh7Qs17KADUJ8wvRSZs=\");\n};\nexport default userSlice.reducer;\n// holds api token, user stats (accuracy, etc), user settings (theme, etc), user account info (level, etc)\n\n// {\n//   \"id\": 440,\n//   \"object\": \"kanji\",\n//   \"url\": \"https://api.wanikani.com/v2/subjects/440\",\n//   \"data_updated_at\": \"2024-12-26T23:20:14.990567Z\",\n//   \"data\": {\n//       \"created_at\": \"2012-02-27T19:55:19.000000Z\",\n//       \"level\": 1,\n//       \"slug\": \"一\",\n//       \"hidden_at\": null,\n//       \"document_url\": \"https://www.wanikani.com/kanji/%E4%B8%80\",\n//       \"characters\": \"一\",\n//       \"meanings\": [\n//           {\n//               \"meaning\": \"One\",\n//               \"primary\": true,\n//               \"accepted_answer\": true\n//           }\n//       ],\n//       \"auxiliary_meanings\": [\n//           {\n//               \"meaning\": \"1\",\n//               \"type\": \"whitelist\"\n//           }\n//       ],\n//       \"readings\": [\n//           {\n//               \"reading\": \"いち\",\n//               \"primary\": true,\n//               \"accepted_answer\": true,\n//               \"type\": \"onyomi\"\n//           },\n//           {\n//               \"reading\": \"いつ\",\n//               \"primary\": false,\n//               \"accepted_answer\": true,\n//               \"type\": \"onyomi\"\n//           },\n//           {\n//               \"reading\": \"ひと\",\n//               \"primary\": false,\n//               \"accepted_answer\": false,\n//               \"type\": \"kunyomi\"\n//           },\n//           {\n//               \"reading\": \"かず\",\n//               \"primary\": false,\n//               \"accepted_answer\": false,\n//               \"type\": \"nanori\"\n//           }\n//       ],\n//       \"component_subject_ids\": [\n//           1\n//       ],\n//       \"amalgamation_subject_ids\": [\n//           2467,\n//           2468,\n//           2477,\n//           2510,\n//           2544,\n//           2588,\n//           2627,\n//           2660,\n//           2665,\n//           2672,\n//           2679,\n//           2721,\n//           2730,\n//           2751,\n//           2959,\n//           3048,\n//           3256,\n//           3335,\n//           3348,\n//           3349,\n//           3372,\n//           3481,\n//           3527,\n//           3528,\n//           3656,\n//           3663,\n//           4133,\n//           4173,\n//           4258,\n//           4282,\n//           4563,\n//           4615,\n//           4701,\n//           4823,\n//           4906,\n//           5050,\n//           5224,\n//           5237,\n//           5349,\n//           5362,\n//           5838,\n//           6010,\n//           6029,\n//           6150,\n//           6169,\n//           6209,\n//           6210,\n//           6346,\n//           6584,\n//           6614,\n//           6723,\n//           6811,\n//           6851,\n//           7037,\n//           7293,\n//           7305,\n//           7451,\n//           7561,\n//           7617,\n//           7734,\n//           7780,\n//           7927,\n//           8209,\n//           8214,\n//           8414,\n//           8456,\n//           8583,\n//           8709,\n//           8896,\n//           8921,\n//           9056,\n//           9103,\n//           9268,\n//           9286,\n//           9305,\n//           9306,\n//           9331\n//       ],\n//       \"visually_similar_subject_ids\": [],\n//       \"meaning_mnemonic\": \"Lying on the <radical>ground</radical> is something that looks just like the ground, the number <kanji>One</kanji>. Why is this One lying down? It's been shot by the number two. It's lying there, bleeding out and dying. The number One doesn't have long to live.\",\n//       \"meaning_hint\": \"To remember the meaning of <kanji>One</kanji>, imagine yourself there at the scene of the crime. You grab <kanji>One</kanji> in your arms, trying to prop it up, trying to hear its last words. Instead, it just splatters some blood on your face. \\\"Who did this to you?\\\" you ask. The number One points weakly, and you see number Two running off into an alleyway. He's always been jealous of number One and knows he can be number one now that he's taken the real number one out.\",\n//       \"reading_mnemonic\": \"As you're sitting there next to <kanji>One</kanji>, holding him up, you start feeling a weird sensation all over your skin. From the wound comes a fine powder (obviously coming from the special bullet used to kill One) that causes the person it touches to get extremely <reading>itchy</reading> (いち).\",\n//       \"reading_hint\": \"Make sure you feel the ridiculously <reading>itchy</reading> sensation covering your body. It climbs from your hands, where you're holding the number <kanji>One</kanji> up, and then goes through your arms, crawls up your neck, goes down your body, and then covers everything. It becomes uncontrollable, and you're scratching everywhere, writhing on the ground. It's so itchy that it's the most painful thing you've ever experienced (you should imagine this vividly, so you remember the reading of this kanji).\",\n//       \"lesson_position\": 25,\n//       \"spaced_repetition_system_id\": 2\n//   }\n// }","map":{"version":3,"names":["createSlice","axios","userSlice","name","initialState","apiKey","level","kanjiIds","reducers","setApiKey","state","action","payload","setLevel","setKanjiIds","console","log","actions","initStudyByLevel","selectedLevels","selectedStages","_s","$RefreshSig$","dispatch","useState","url","user","fetchIds","get","headers","Authorization","then","res","data","map","kanji","visually_similar_subject_ids","length","id","character","characters","meanings","meaning","similarIds","pages","per_page","total_count","next_url","catch","err","reducer"],"sources":["/Users/smanor/Development/code/personal/wk-similar/src/reducers/UserReducer.ts"],"sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { Kanji } from \"./QuestionReducer\";\nimport axios from \"axios\";\n\ninterface ReturnedKanjiData {\n  data: {\n    amalgamation_subject_ids: number[];\n    auxiliary_meanings: [\n      {\n        meaning: string;\n        type: string;\n      }\n    ];\n    characters: string;\n    component_subject_ids: number[];\n    created_at: string | null;\n    document_url: string;\n    hidden_at: string | null;\n    lesson_position: number;\n    level: number;\n    meaning_hint: string;\n    meaning_mnemonic: string;\n    meanings: [\n      {\n        meaning: string;\n        primary: boolean;\n        accepted_answer: boolean;\n      }\n    ];\n    reading_hint: string;\n    reading_mnemonic: string;\n    readings: [\n      {\n        reading: string;\n        primary: boolean;\n        accepted_answer: boolean;\n        type: string;\n      }\n    ];\n    slug: string;\n    visually_similar_subject_ids: number[];\n  };\n  data_updated_at: string;\n  id: number;\n  object: \"kanji\";\n  url: string;\n}\n\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    apiKey: \"\",\n    level: 0,\n    kanjiIds: [],\n  },\n  reducers: {\n    setApiKey: (state, action: PayloadAction<string>) => {\n      state.apiKey = action.payload;\n    },\n    setLevel: (state, action: PayloadAction<number>) => {\n      state.level = action.payload;\n    },\n    setKanjiIds: (state, action: PayloadAction<Kanji[]>) => {\n      // state.kanjiIds = action.payload;\n      console.log(action.payload);\n    },\n  },\n});\n\nexport const { setApiKey, setLevel, setKanjiIds } = userSlice.actions;\n\nexport const initStudyByLevel = (\n  selectedLevels: string | null = null,\n  selectedStages: string | null = null\n) => {\n  return async (dispatch: any, useState: any) => {\n    let url = \"https://api.wanikani.com/v2/subjects?types=kanji&started=true\";\n    if (selectedLevels) {\n      url += `&levels=${selectedLevels}`;\n    } else if (selectedStages) {\n      url += `&srs_stages=${selectedStages}`;\n    }\n\n    console.log(\"url\", url);\n    const apiKey = useState().user.apiKey;\n\n    // recursively fetch all pages of kanji ids\n    const fetchIds = async (url: string | null) => {\n      if (url) {\n        await axios\n          .get(url, {\n            headers: {\n              Authorization: `Bearer ${apiKey}`,\n            },\n          })\n          .then((res) => {\n            console.log(\"fetched\", res.data);\n\n            dispatch(\n              setKanjiIds(\n                res.data.data.map((kanji: ReturnedKanjiData) => {\n                  if (kanji.data.visually_similar_subject_ids.length > 1) {\n                    return {\n                      id: kanji.id,\n                      character: kanji.data.characters,\n                      url: kanji.url,\n                      level: kanji.data.level,\n                      meanings: kanji.data.meanings.map(\n                        (meaning) => meaning.meaning\n                      ),\n                      similarIds: kanji.data.visually_similar_subject_ids,\n                    };\n                  }\n                })\n              )\n            );\n\n            if (\n              res.data.pages.per_page > res.data.total_count &&\n              res.data.pages.next_url\n            ) {\n              console.log(\"fetching next page\");\n              fetchIds(res.data.pages.next_url);\n            }\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    };\n\n    // await fetchIds(\n    //   `https://api.wanikani.com/v2/assignments?subject_types=kanji&started=true&levels=${selectedLevels}`\n    // );\n    await fetchIds(url);\n  };\n};\n\nexport default userSlice.reducer;\n// holds api token, user stats (accuracy, etc), user settings (theme, etc), user account info (level, etc)\n\n// {\n//   \"id\": 440,\n//   \"object\": \"kanji\",\n//   \"url\": \"https://api.wanikani.com/v2/subjects/440\",\n//   \"data_updated_at\": \"2024-12-26T23:20:14.990567Z\",\n//   \"data\": {\n//       \"created_at\": \"2012-02-27T19:55:19.000000Z\",\n//       \"level\": 1,\n//       \"slug\": \"一\",\n//       \"hidden_at\": null,\n//       \"document_url\": \"https://www.wanikani.com/kanji/%E4%B8%80\",\n//       \"characters\": \"一\",\n//       \"meanings\": [\n//           {\n//               \"meaning\": \"One\",\n//               \"primary\": true,\n//               \"accepted_answer\": true\n//           }\n//       ],\n//       \"auxiliary_meanings\": [\n//           {\n//               \"meaning\": \"1\",\n//               \"type\": \"whitelist\"\n//           }\n//       ],\n//       \"readings\": [\n//           {\n//               \"reading\": \"いち\",\n//               \"primary\": true,\n//               \"accepted_answer\": true,\n//               \"type\": \"onyomi\"\n//           },\n//           {\n//               \"reading\": \"いつ\",\n//               \"primary\": false,\n//               \"accepted_answer\": true,\n//               \"type\": \"onyomi\"\n//           },\n//           {\n//               \"reading\": \"ひと\",\n//               \"primary\": false,\n//               \"accepted_answer\": false,\n//               \"type\": \"kunyomi\"\n//           },\n//           {\n//               \"reading\": \"かず\",\n//               \"primary\": false,\n//               \"accepted_answer\": false,\n//               \"type\": \"nanori\"\n//           }\n//       ],\n//       \"component_subject_ids\": [\n//           1\n//       ],\n//       \"amalgamation_subject_ids\": [\n//           2467,\n//           2468,\n//           2477,\n//           2510,\n//           2544,\n//           2588,\n//           2627,\n//           2660,\n//           2665,\n//           2672,\n//           2679,\n//           2721,\n//           2730,\n//           2751,\n//           2959,\n//           3048,\n//           3256,\n//           3335,\n//           3348,\n//           3349,\n//           3372,\n//           3481,\n//           3527,\n//           3528,\n//           3656,\n//           3663,\n//           4133,\n//           4173,\n//           4258,\n//           4282,\n//           4563,\n//           4615,\n//           4701,\n//           4823,\n//           4906,\n//           5050,\n//           5224,\n//           5237,\n//           5349,\n//           5362,\n//           5838,\n//           6010,\n//           6029,\n//           6150,\n//           6169,\n//           6209,\n//           6210,\n//           6346,\n//           6584,\n//           6614,\n//           6723,\n//           6811,\n//           6851,\n//           7037,\n//           7293,\n//           7305,\n//           7451,\n//           7561,\n//           7617,\n//           7734,\n//           7780,\n//           7927,\n//           8209,\n//           8214,\n//           8414,\n//           8456,\n//           8583,\n//           8709,\n//           8896,\n//           8921,\n//           9056,\n//           9103,\n//           9268,\n//           9286,\n//           9305,\n//           9306,\n//           9331\n//       ],\n//       \"visually_similar_subject_ids\": [],\n//       \"meaning_mnemonic\": \"Lying on the <radical>ground</radical> is something that looks just like the ground, the number <kanji>One</kanji>. Why is this One lying down? It's been shot by the number two. It's lying there, bleeding out and dying. The number One doesn't have long to live.\",\n//       \"meaning_hint\": \"To remember the meaning of <kanji>One</kanji>, imagine yourself there at the scene of the crime. You grab <kanji>One</kanji> in your arms, trying to prop it up, trying to hear its last words. Instead, it just splatters some blood on your face. \\\"Who did this to you?\\\" you ask. The number One points weakly, and you see number Two running off into an alleyway. He's always been jealous of number One and knows he can be number one now that he's taken the real number one out.\",\n//       \"reading_mnemonic\": \"As you're sitting there next to <kanji>One</kanji>, holding him up, you start feeling a weird sensation all over your skin. From the wound comes a fine powder (obviously coming from the special bullet used to kill One) that causes the person it touches to get extremely <reading>itchy</reading> (いち).\",\n//       \"reading_hint\": \"Make sure you feel the ridiculously <reading>itchy</reading> sensation covering your body. It climbs from your hands, where you're holding the number <kanji>One</kanji> up, and then goes through your arms, crawls up your neck, goes down your body, and then covers everything. It becomes uncontrollable, and you're scratching everywhere, writhing on the ground. It's so itchy that it's the most painful thing you've ever experienced (you should imagine this vividly, so you remember the reading of this kanji).\",\n//       \"lesson_position\": 25,\n//       \"spaced_repetition_system_id\": 2\n//   }\n// }\n"],"mappings":"AAAA,SAASA,WAAW,QAAuB,kBAAkB;AAE7D,OAAOC,KAAK,MAAM,OAAO;AA8CzB,MAAMC,SAAS,GAAGF,WAAW,CAAC;EAC5BG,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,MAAM,EAAE,EAAE;IACVC,KAAK,EAAE,CAAC;IACRC,QAAQ,EAAE;EACZ,CAAC;EACDC,QAAQ,EAAE;IACRC,SAAS,EAAEA,CAACC,KAAK,EAAEC,MAA6B,KAAK;MACnDD,KAAK,CAACL,MAAM,GAAGM,MAAM,CAACC,OAAO;IAC/B,CAAC;IACDC,QAAQ,EAAEA,CAACH,KAAK,EAAEC,MAA6B,KAAK;MAClDD,KAAK,CAACJ,KAAK,GAAGK,MAAM,CAACC,OAAO;IAC9B,CAAC;IACDE,WAAW,EAAEA,CAACJ,KAAK,EAAEC,MAA8B,KAAK;MACtD;MACAI,OAAO,CAACC,GAAG,CAACL,MAAM,CAACC,OAAO,CAAC;IAC7B;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEH,SAAS;EAAEI,QAAQ;EAAEC;AAAY,CAAC,GAAGZ,SAAS,CAACe,OAAO;AAErE,OAAO,MAAMC,gBAAgB,GAAGA,CAC9BC,cAA6B,GAAG,IAAI,EACpCC,cAA6B,GAAG,IAAI,KACjC;EAAA,IAAAC,EAAA,GAAAC,YAAA;EACH,OAAAD,EAAA,CAAO,OAAOE,QAAa,EAAEC,QAAa,KAAK;IAAAH,EAAA;IAC7C,IAAII,GAAG,GAAG,+DAA+D;IACzE,IAAIN,cAAc,EAAE;MAClBM,GAAG,IAAI,WAAWN,cAAc,EAAE;IACpC,CAAC,MAAM,IAAIC,cAAc,EAAE;MACzBK,GAAG,IAAI,eAAeL,cAAc,EAAE;IACxC;IAEAL,OAAO,CAACC,GAAG,CAAC,KAAK,EAAES,GAAG,CAAC;IACvB,MAAMpB,MAAM,GAAGmB,QAAQ,CAAC,CAAC,CAACE,IAAI,CAACrB,MAAM;;IAErC;IACA,MAAMsB,QAAQ,GAAG,MAAOF,GAAkB,IAAK;MAC7C,IAAIA,GAAG,EAAE;QACP,MAAMxB,KAAK,CACR2B,GAAG,CAACH,GAAG,EAAE;UACRI,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUzB,MAAM;UACjC;QACF,CAAC,CAAC,CACD0B,IAAI,CAAEC,GAAG,IAAK;UACbjB,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEgB,GAAG,CAACC,IAAI,CAAC;UAEhCV,QAAQ,CACNT,WAAW,CACTkB,GAAG,CAACC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAEC,KAAwB,IAAK;YAC9C,IAAIA,KAAK,CAACF,IAAI,CAACG,4BAA4B,CAACC,MAAM,GAAG,CAAC,EAAE;cACtD,OAAO;gBACLC,EAAE,EAAEH,KAAK,CAACG,EAAE;gBACZC,SAAS,EAAEJ,KAAK,CAACF,IAAI,CAACO,UAAU;gBAChCf,GAAG,EAAEU,KAAK,CAACV,GAAG;gBACdnB,KAAK,EAAE6B,KAAK,CAACF,IAAI,CAAC3B,KAAK;gBACvBmC,QAAQ,EAAEN,KAAK,CAACF,IAAI,CAACQ,QAAQ,CAACP,GAAG,CAC9BQ,OAAO,IAAKA,OAAO,CAACA,OACvB,CAAC;gBACDC,UAAU,EAAER,KAAK,CAACF,IAAI,CAACG;cACzB,CAAC;YACH;UACF,CAAC,CACH,CACF,CAAC;UAED,IACEJ,GAAG,CAACC,IAAI,CAACW,KAAK,CAACC,QAAQ,GAAGb,GAAG,CAACC,IAAI,CAACa,WAAW,IAC9Cd,GAAG,CAACC,IAAI,CAACW,KAAK,CAACG,QAAQ,EACvB;YACAhC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;YACjCW,QAAQ,CAACK,GAAG,CAACC,IAAI,CAACW,KAAK,CAACG,QAAQ,CAAC;UACnC;QACF,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,IAAK;UACdlC,OAAO,CAACC,GAAG,CAACiC,GAAG,CAAC;QAClB,CAAC,CAAC;MACN;IACF,CAAC;;IAED;IACA;IACA;IACA,MAAMtB,QAAQ,CAACF,GAAG,CAAC;EACrB,CAAC;AACH,CAAC;AAED,eAAevB,SAAS,CAACgD,OAAO;AAChC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}